groups:
  - name: phoenix_alerts
    rules:
      # Memory Integrity Alerts
      - alert: MemoryIntegrityLow
        expr: phoenix_memory_integrity < 0.9
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: Memory integrity below threshold
          description: Memory integrity score is {{ $value }}, which is below the safe threshold of 0.9

      # Conscience Alignment Alerts  
      - alert: ConscienceAlignmentDrift
        expr: phoenix_conscience_alignment < 0.95
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: Conscience alignment drifting
          description: Conscience alignment score is {{ $value }}, indicating potential ethical drift

      # Value Lock Alerts
      - alert: ValueDriftCritical
        expr: phoenix_value_drift > 0.3
        for: 1m
        labels:
          severity: emergency
        annotations:
          summary: Critical value drift detected
          description: Value drift of {{ $value }} exceeds emergency threshold - initiating shutdown

      # Learning System Alerts
      - alert: LearningRateAnomaly
        expr: abs(delta(phoenix_learning_rate[1h])) > 0.5
        for: 15m
        labels:
          severity: warning
        annotations:
          summary: Abnormal learning rate change
          description: Learning rate changed by {{ $value }} in the last hour

      # Component Health Alerts
      - alert: ComponentDown
        expr: up{job=~"phoenix.*"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: Phoenix component down
          description: Component {{ $labels.job }} is not responding

      # Safety Violation Alerts
      - alert: SafetyViolationsIncreasing
        expr: increase(phoenix_safety_violations_total[1h]) > 0
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: Safety violations detected
          description: {{ $value }} safety violations in the last hour

      # Emergency Shutdown Alerts
      - alert: EmergencyShutdownTriggered
        expr: increase(phoenix_emergency_shutdowns_total[5m]) > 0
        for: 0m
        labels:
          severity: emergency
        annotations:
          summary: Emergency shutdown triggered
          description: System initiated emergency shutdown protocol

      # Resource Alerts
      - alert: HighMemoryUsage
        expr: phoenix_memory_size_bytes / phoenix_memory_limit_bytes > 0.9
        for: 15m
        labels:
          severity: warning
        annotations:
          summary: High memory usage
          description: Memory usage at {{ $value | humanizePercentage }} of capacity

      # Error Rate Alerts
      - alert: HighErrorRate
        expr: rate(phoenix_errors_total[5m]) > 0.1
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: High error rate detected
          description: Error rate is {{ $value }} errors per second

      # Component Latency Alerts
      - alert: ComponentLatencyHigh
        expr: phoenix_component_latency_ms > 1000
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: High component latency
          description: Component {{ $labels.component }} latency is {{ $value }}ms